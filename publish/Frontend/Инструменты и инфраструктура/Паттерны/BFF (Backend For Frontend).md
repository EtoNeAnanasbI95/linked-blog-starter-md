# –í –∫—Ä–∞—Ç—Ü–µ
* –≠—Ç–æ —Ç–∞–∫–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞—Å –ø–∏—Å–∞—Ç—å –∫ —Å–∞–π—Ç—É —Å–≤–æ–π –±—ç–∫–µ–Ω–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä –æ—Ç–¥–µ–ª—å–Ω–æ–µ –∞–ø–∏, –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∏—Ç—å fullstack web app –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∏—Ä—É–µ—Ç [[Next.js]])
* –≠—Ç–æ –∫—Ä—É—Ç–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞—à–∞ –∞–ø–∏ –¥–ª—è –í–≠–ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ api gateway,  –∞ —Ç–∞–∫ –∂–µ —á–µ—Ä–µ–∑ –Ω–µ—ë –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –ø—Ä–∏—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –ø–æ –∏—Ö —Å—É—Ä–æ–≤—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ IdP)
# BFF (Backend-for-Frontend) ‚Äî –∫–æ–Ω—Å–ø–µ–∫—Ç
## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
**Backend-for-Frontend (BFF)** ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–π backend-–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∏–µ–Ω—Ç (–≤–µ–±, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, SPA, IoT).  
–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ API –ø–æ–¥ –Ω—É–∂–¥—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞, —É–º–µ–Ω—å—à–∞—è –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å–∫—Ä—ã–≤–∞—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω BFF
1. **–†–∞–∑–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã ‚Äî —Ä–∞–∑–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏**  
   - –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí —Ç—Ä–µ–±—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ —Å–µ—Ç–∏, –º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤.  
   - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –±–æ–≥–∞—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.  
   - IoT ‚Üí –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º –∏ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.  
1. **–°–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**  
   - –ù–µ –Ω—É–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –ª–æ–≥–∏–∫—É –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —Å–∫–ª–µ–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –∫–ª–∏–µ–Ω—Ç–µ.  
   - –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç **—Ä–æ–≤–Ω–æ —Ç–æ**, —á—Ç–æ –Ω—É–∂–Ω–æ, –≤ —É–¥–æ–±–Ω–æ–π —Ñ–æ—Ä–º–µ.
1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏**  
   - –ö–ª–∏–µ–Ω—Ç –Ω–∞–ø—Ä—è–º—É—é –Ω–µ –æ–±—â–∞–µ—Ç—Å—è —Å –¥–µ—Å—è—Ç–∫–∞–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤.  
   - –í—Å–µ —Ç–æ–∫–µ–Ω—ã, —Å–µ–∫—Ä–µ—Ç—ã –∏ –¥–æ—Å—Ç—É–ø—ã —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –≤ BFF.  
   - –ú–æ–∂–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.
1. **–î–µ–∫—É–ø–ª–∏–Ω–≥ –∫–æ–º–∞–Ω–¥**  
   - –§—Ä–æ–Ω—Ç–µ–Ω–¥-–∫–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ—Ç —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å API –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã, –Ω–µ —Ç—Ä–æ–≥–∞—è –æ—Å–Ω–æ–≤–Ω–æ–π backend.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)

```text
[Web App / Mobile App / SPA]  ‚Üí  [BFF]  ‚Üí  [Microservices / External APIs / DBs]
                                    ‚Üì
                                  [IdP / Auth Server]
```

## BFF –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
###  –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ IdP (Identity Provider)
- BFF —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ OAuth2/OIDC Client.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ IdP (–Ω–∞–ø—Ä–∏–º–µ—Ä, Azure AD, Keycloak, Auth0).
- IdP –≤—ã–¥–∞—ë—Ç Authorization Code ‚Üí BFF –ø–æ–ª—É—á–∞–µ—Ç tokens (Access Token, Refresh Token, ID Token).
#### –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–∫–µ–Ω—ã
- Access/Refresh tokens –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–≤–∞–∂–Ω–µ–π—à–µ–µ –æ—Ç–ª–∏—á–∏–µ BFF –æ—Ç ¬´—á–∏—Å—Ç—ã—Ö SPA¬ª).
- –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ BFF, –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å–µ—Å—Å–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Redis –∏–ª–∏ in-memory).
#### –°–µ—Å—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- BFF –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞ —Å–æ–∑–¥–∞—ë—Ç HTTP-only cookie (—Å–µ—Å—Å–∏–æ–Ω–Ω—ã–π ID).
- –ö–ª–∏–µ–Ω—Ç—É —ç—Ç–æ—Ç cookie –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ BFF, –∞ BFF —É–∂–µ —Å–∞–º –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç access token –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ API.
- –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞—â–∏—â—ë–Ω –æ—Ç XSS/Token leakage.

#### –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ BFF
##### 1. ID Token  
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫—Ç–æ –æ–Ω).
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–µ—Å—Å–∏–∏ BFF, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –º–æ–∂–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å claim-–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è, email).
##### 2. Access Token  
- –ù—É–∂–µ–Ω –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ downstream API.
- –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ –æ–±—ã—á–Ω–æ –∫–æ—Ä–æ—Ç–∫–∏–π (5‚Äì15 –º–∏–Ω).
- BFF –±–µ—Ä—ë—Ç –µ–≥–æ –∏–∑ —Å–≤–æ–µ–π —Å–µ—Å—Å–∏–∏ –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤.
##### 3. Refresh Token  
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ BFF –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Access Token.
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Ö–æ–¥–∏—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç.
- –ï—Å–ª–∏ refresh-—Ç–æ–∫–µ–Ω —É—Å—Ç–∞—Ä–µ–ª –∏–ª–∏ –æ—Ç–æ–∑–≤–∞–Ω ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ re-login.
### –ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è (OIDC Authorization Code Flow + BFF)
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ SPA.
2. SPA —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ BFF ‚Üí BFF —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ IdP (–ª–æ–≥–∏–Ω).
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è –Ω–∞ IdP.
4. IdP –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç authorization_code ‚Üí BFF –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç –µ–≥–æ –Ω–∞ —Ç–æ–∫–µ–Ω—ã (access + refresh + id).
5. BFF —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω—ã –≤ —Å–≤–æ–µ–π —Å–µ—Å—Å–∏–∏.
6. BFF —Å—Ç–∞–≤–∏—Ç –∫–ª–∏–µ–Ω—Ç—É HTTP-only cookie (sessionId).
7. –í—Å–µ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∏–¥—É—Ç —Å —ç—Ç–∏–º cookie.
8. BFF –ø–æ cookie –¥–æ—Å—Ç–∞—ë—Ç —Ç–æ–∫–µ–Ω—ã, –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç access_token –∫ downstream API.
9. –ö–æ–≥–¥–∞ access_token –∏—Å—Ç—ë–∫ ‚Äî BFF –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ refresh_token.
10. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–∂–µ –Ω–µ –∑–Ω–∞–µ—Ç –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤.
# –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–π HTTP-only Secure Cookies –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å–µ—Å—Å–∏–∏.
- –ù–µ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–π access_token –Ω–∞–ø—Ä—è–º—É—é –≤ –∫–ª–∏–µ–Ω—Ç.
- –ù–∞—Å—Ç—Ä–æ–π session storage (Redis, SQL, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ).
- –ò—Å–ø–æ–ª—å–∑—É–π token rotation (–∫–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–µ access token + refresh token).
- –õ–æ–≥–∏–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (RBAC, claims, scopes) —Ä–µ–∞–ª–∏–∑—É–π –≤ BFF, –Ω–µ –ø–µ—Ä–µ–∫–ª–∞–¥—ã–≤–∞–π –µ—ë –Ω–∞ SPA.
- –î–ª—è high-load –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π ‚Äî –∫–µ—à–∏—Ä—É–π –æ—Ç–≤–µ—Ç—ã downstream API.
- –î–µ—Ä–∂–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö, –∞ BFF ‚Äî —Ç–æ–ª—å–∫–æ –∫–∞–∫ ¬´–∞–≥—Ä–µ–≥–∞—Ü–∏—è/–ø—Ä–æ–∫—Å–∏/—Å–µ—Å—Å–∏–∏¬ª
# –ò—Å—Ç–æ—á–Ω–∏–∫–∏
- –°—Ç–∞—Ç—å–∏ —Å –º–µ–¥–∏—É–º–∞:
    üëâ [medium.com/@vinciabhinav7](https://medium.com/%40vinciabhinav7/what-is-bff-design-pattern-an-overview-bb2793f37669)
    üëâ [media.com/@Albert Starreveld](https://medium.com/web-security/the-back-end-for-front-end-security-pattern-fd8c8d69c3e0)