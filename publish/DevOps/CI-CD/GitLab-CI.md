# Кратенько
* Самый вайбовый и удобный из всех CI что я делал. Мега прост в освоении и ещё проще в родключении
* Короче есть ранеры, ты делаешь их сам, либо ставишь прям бинарник ранера и он крутится у тебя на машине, либо ты запускаешь докер образ и это уже и будет твоим ранером
* Сами пайпалйны обязательно делиться на стадии, и пишутся в gitlab-ci.yml файликах
---
# Пример
* Вот пример написанного пайплайна для сайта на условном next.js
```yaml
stages:
  - build
  - deploy

create_env:
  stage: build
  script:
    - echo "GITLAB_TOKEN=$GITLAB_TOKEN" > .env
  artifacts:
    paths:
      - .env

gitlab-servers-build-and-push:
  stage: build
  image: docker:latest
  services:
    - docker:dind
  needs:
    - create_env
  before_script:
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
  script:
    - echo "Build docker image on gitlab server"
    - docker build -t $CI_REGISTRY_IMAGE:latest .
    - docker push $CI_REGISTRY_IMAGE:latest
  only:
    - main

self-hosted-deploy:
  stage: deploy
  image: docker:latest
  script:
    - echo "Run self-hosted deploy"
    - docker network create site-network || true
    - docker compose stop || true
    - docker compose pull
    - docker compose up -d
  only:
    - main
  tags:
    - self-hosted

```

* Из интересного, тут используется гитлабовский реестр контейнеров, а так же мой личный ранер, на моей машине, специально для развертывания на нём продакшона
# Обширное описание
## Основные фишки GitLab CI и инфраструктуры GitLab

GitLab CI — это не просто «запускалка пайплайнов», а часть экосистемы GitLab, где CI/CD глубоко интегрирован с репозиториями, управлением проектами и артефактами. Вот ключевые возможности, которые делают его особенно удобным:

### Registry (Контейнеры и пакеты)
- **Container Registry**  
  Встроенный приватный реестр Docker-образов.  
  *Можно пушить образы прямо из пайплайнов, а потом использовать их в деплое.*
- **Package Registry**  
  Поддержка пакетов для разных языков и экосистем: npm, Maven, PyPI, NuGet, Go modules и др.  
  *Позволяет хранить и распространять свои библиотеки и пакеты внутри компании.*
### Управление артефактами
- Артефакты (например, бинарники, архивы, логи) можно сохранять после выполнения джобов и передавать между стадиями.
- Поддерживается настройка TTL: можно хранить артефакты временно или навсегда.
- Очень удобно для кеширования зависимостей и ускорения билдов.

### Гибкая настройка пайплайнов
- **Stages и jobs** — пайплайны можно разбивать на стадии (build/test/deploy), а внутри них на отдельные задачи.
- **`needs` и `dependencies`** — можно точно описать порядок и зависимости между джобами.
- **Dynamic pipelines** — пайплайны можно собирать из шаблонов и использовать `include` для переиспользования.
- **Rules/Only/Except** — запуск задач по условию: ветка, тег, MR, переменные окружения.

### Интеграция с GitLab
- **Merge Request pipelines** — автоматический запуск CI/CD при создании MR с видимой проверкой «прошёл билд или нет».
- **Environments & Deployments** — GitLab отслеживает окружения (staging, prod) и историю деплоев.
- **Review Apps** — возможность на лету поднимать временные окружения для проверки фичи прямо из MR.

### GitLab Runners
- **Shared Runners** — общие раннеры, которые GitLab предоставляет «из коробки».
- **Self-hosted Runners** — можно поставить свой раннер (на сервере, в докере, в Kubernetes) и подстроить его под любые задачи.
- **Tags** — управление, какой раннер возьмёт конкретную задачу (например, `self-hosted`, `windows`, `gpu`)

### Секреты и переменные
- Хранение переменных окружения (пароли, токены, ключи) внутри GitLab.
- Поддержка **protected variables** для продакшн-окружений.
- Можно использовать как на уровне проекта, так и на уровне всей группы.

### Безопасность и проверка качества
- GitLab умеет интегрировать **Security scans** прямо в пайплайны (SAST, DAST, Dependency Scanning).
- Автоматическая проверка зависимостей и уязвимостей.
- Возможность блокировать merge, если пайплайн или проверки безопасности не прошли.
### Масштабирование и интеграции
- **Kubernetes integration** — GitLab может деплоить приложения прямо в кластер.
- **Terraform integration** — хранение стейтов и запуск IaC через пайплайны.
- **API и Webhooks** — почти всё в GitLab CI доступно через API, удобно для автоматизации.

✨ **Итог:** GitLab CI — это «all-in-one» решение: репозиторий кода, пайплайны, реестры, артефакты, мониторинг и деплой в одном месте. Это сильно упрощает инфраструктуру и убирает необходимость городить отдельные сервисы для разных задач.