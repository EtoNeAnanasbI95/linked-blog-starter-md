# Объектное хранение
## Вкратце
- **Что это?** 
  Данные хранятся как **объекты** в плоской структуре (не иерархия папок). Каждый объект состоит из:
  - Данных (сам файл).
  - Метаданных (например, имя, дата создания, теги).
  - Уникального идентификатора (ключа) для доступа.
- **Как работает?**
  - Объекты хранятся в "бакетах" (buckets). Нет папок, но можно эмулировать их через ключи (например, `folder/subfolder/file.txt`).
  - Доступ через API (обычно S3-совместимый, как в MinIO).
- **Примеры использования:**
  - Хранение больших объемов данных: бэкапы, медиафайлы (видео, картинки), логи.
  - Веб-приложения, где нужен доступ к файлам по URL или ключу.
- **Плюсы:**
  - Масштабируемость (легко хранить петабайты данных).
  - Простота доступа через API.
  - Высокая отказоустойчивость (данные реплицируются).
- **Минусы:**
  - Не подходит для частых обновлений (объекты неизменяемы, для изменения — перезапись).
  - Неэффективно для работы с файлами, требующими быстрого доступа (например, базы данных).
## Объяснение
1. Как реально хранятся данные
	•	Физически: Любое объектное хранилище кладёт файлы на диски, часто поверх RAID/ZFS/erasure coding.
	•	Объект = blob:
	•	Сам файл (байты).
	•	Метаданные (например, Content-Type, кастомные x-amz-meta-\*).
	•	Ключ (идентификатор).
	•	Внутри движка (например, у Ceph — RADOS, у [[MinIO]] — распределённый key-value store поверх дисков) объект записывается в хранилище с разбиением и репликацией:
	•	Может быть 3 реплики на разных узлах.
	•	Или erasure coding (разбивка на куски и хранение с “чек-суммами”, как в RAID-6, только гибче).

2. Консистентность
	•	Amazon S3 исторически давал eventual consistency (данные могут появиться с задержкой).
	•	MinIO и новые версии Ceph могут гарантировать strong consistency (после записи — мгновенно доступно).
	•	Для этого под капотом используется распределённый журнал транзакций, согласование через consensus-протоколы (Raft/Paxos).

3. Шардинг и масштабирование
	•	Объекты не лежат “в одной папке”.
	•	Обычно применяется hashing ключа → попадает в конкретный shard → хранится на определённых дисках/нодах.
	•	S3 ключ — это просто строка (например, folder1/folder2/file.txt). Внутри никакой иерархии нет, это плоское пространство. “Папки” — лишь префиксы

# Блочное хранение
- **Что это?**
  Данные хранятся как **блоки** фиксированного размера, без метаданных. Это как виртуальный жесткий диск, разбитый на куски.
- **Как работает?**
  - Блоки идентифицируются по адресу (не по имени файла).
  - Используется для низкоуровневого доступа, обычно через протоколы iSCSI или как часть виртуальных машин.
  - ОС видит блочное хранилище как диск, на котором можно создать файловую систему (например, ext4, NTFS).
- **Примеры использования:**
  - Хранение данных для виртуальных машин (VMware, KVM).
  - Базы данных (MySQL, PostgreSQL), где нужен быстрый доступ к данным.
  - Локальные диски для контейнеров или приложений.
- **Плюсы:**
  - Высокая производительность (низкая задержка, быстрый доступ).
  - Подходит для приложений, требующих частого чтения/записи.
- **Минусы:**
  - Сложнее масштабировать (нужны дополнительные инструменты).
  - Обычно дороже, чем объектное хранение.
  - Нет встроенных метаданных.
- **Пример сервиса:** Amazon EBS, Ceph (через RBD — RADOS Block Device), Google Persistent Disk.

# Файловое хранение
- **Что это?**
  Данные хранятся в виде **файлов** и **папок** в иерархической структуре, как на обычном жестком диске или NAS.
- **Как работает?**
  - Используются протоколы NFS, SMB/CIFS или AFP.
  - Доступ через файловую систему (например, монтируется как сетевой диск).
  - Поддерживает права доступа, блокировки файлов и т.д.
- **Примеры использования:**
  - Общие папки для команд (например, в офисе).
  - Хранение документов, доступных через сеть.
  - Локальные приложения, работающие с файлами (например, редакторы кода).
- **Плюсы:**
  - Интуитивно понятно (как работа с папками на компьютере).
  - Подходит для совместной работы.
- **Минусы:**
  - Ограниченная масштабируемость (сложно хранить терабайты данных).
  - Производительность ниже, чем у блочного хранения.
  - Сложнее обеспечить отказоустойчивость.
- **Пример сервиса:** NFS-сервер, Ceph (через CephFS), Amazon EFS, Google Filestore.
# Таблица отличий 

| Тип хранения  | Структура данных                   | Доступ                       | Использование                   | Пример сервиса          |
| ------------- | ---------------------------------- | ---------------------------- | ------------------------------- | ----------------------- |
| **Объектное** | Объекты (файл + метаданные + ключ) | API (S3, HTTP)               | Бэкапы, медиа, большие данные   | MinIO, Amazon S3        |
| **Блочное**   | Блоки (без метаданных)             | Низкоуровневый (iSCSI, диск) | Виртуальные машины, базы данных | Amazon EBS, Ceph RBD    |
| **Файловое**  | Файлы и папки                      | NFS, SMB, файловая система   | Общие папки, документы          | NFS, CephFS, Amazon EFS |
