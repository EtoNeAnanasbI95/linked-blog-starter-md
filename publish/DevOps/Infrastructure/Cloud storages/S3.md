# Объяснение
* S3 API — это HTTP-протокол для доступа к объектам, изначально придуманный Amazon.
На практике это де-факто стандарт: [[MinIO]], Ceph, DigitalOcean Spaces, Wasabi и другие полностью копируют этот API, чтобы клиенты AWS работали без изменений.
## Основные операции
Это просто REST API с CRUD над объектами и бакетами:
- **PUT Object** → загрузить объект.
```
PUT /mybucket/photo.jpg
Host: s3.amazonaws.com
Authorization: AWS <key>:<signature>
Content-Type: image/jpeg
```
	→ тело запроса = сам файл.
- **GET Object** → скачать объект.
```
GET /mybucket/photo.jpg
Host: s3.amazonaws.com
Authorization: AWS <key>:<signature>
```
- **DELETE Object** → удалить объект.
- **LIST Objects (v2)** (LIST это не http метод, это свой надстройка в рамках s3) → получить список объектов в бакете (с поддержкой префиксов и пагинации).
- **HEAD Object** → метаданные объекта (не скачивая тело).
## Аутентификация (Signature V2/V4)
- Запросы к S3 подписываются ключом:  
	- Access Key ID (как логин).
	- Secret Key (как пароль).
- Подпись вычисляется из:  
	- метода (GET/PUT/…),
	- даты,
	- пути (/bucket/object),
	- заголовков.
- Signature V4 (современный вариант):  
	- Формирует канонический запрос.
	- Хэшируется через SHA256.
	- Подписывается HMAC-SHA256 секретным ключом.
- Это позволяет серверу убедиться, что запрос авторизован, и его никто не подделал.
## Модели доступа
- Path-style: https://s3.amazonaws.com/mybucket/photo.jpg.
- Virtual-hosted style: https://mybucket.s3.amazonaws.com/photo.jpg.
- Pre-signed URLs: клиенту можно дать ссылку с подписью, которая работает ограниченное время (например, для скачивания файла без ключа).
## Multipart Upload
Для больших файлов (гигабайты/терабайты):
- Делим файл на части (обычно 5–100 MB).
- Загружаем каждую часть отдельным PUT.
- Завершаем сессией CompleteMultipartUpload.
- Это позволяет:  
	- параллелить загрузку,
	- докачивать при сбое,
	- не держать файл целиком в памяти.
## Event Notifications & Versioning
- Versioning: каждый объект может иметь несколько версий (file.txt?v=1, v=2 и т.д.).
- Events: можно настроить уведомления (например, “при загрузке объекта — вызвать Lambda/HTTP hook”).
## Особенности API
- S3 API — это низкоуровневый файловый сервис через HTTP.
- Нет транзакций или частичного обновления (только overwrite).
- Метаданные ограничены (всё хранится в x-amz-meta-\*).
- API максимально примитивен, но зато работает везде одинаково.
## Как это выглядит в реальности
- MinIO запускает кластер, диски объявляются как storage pool.
- Каждый PUT Object → MinIO:
	1. Делает hash ключа.
	2. Определяет, куда класть объект (в какой shard/disks).
	3. Делит данные на чанки.
	4. Записывает их с репликацией/erasure coding.    
- Метаданные (ключ, размер, ETag, кастомные поля) — в key-value базе (у MinIO это distributed etcd-like store).
- Доступ — строго через S3 API (HTTP).